## NVRAM configuration file. 
##
## Explains the contents of the system's non volatile RAM
## as seen and manipulated by the nvram utility.


## The nvram type is set with the directive
##     * hardware HARDWARE_NAME
##
## HARDWARE_NAME may be
##     * intel    (for Intel ICHx southbridge series)
##     * via82cxx (for VIA 82Cxx ISA bridge series)
##     * via823x  (for VIA 823x ISA bridge series)
##     * ds1685   (for distinct DS1685 RTC chips)
## 
## If no or a wrong hardware directive is given, the extended NVRAM (Bytes 128
## and above) is not accessible.
hardware via823x


## The include directive allows to include other configuration files at the
## point where the include directive was given. Includes may be nested.
#include /etc/nvram.d/anyfile


## The NVRAM configuration lists a number of fields, each with a position and
## size given in bytes. The resulting map is applied to the system's NVRAM.
## If a field in the map exceeds the NVRAM size in the actual system, reads
## of such fields return always 0xff in the locations where no further NVRAM
## exists, and writes are a no-op in such regions. So the last entry which
## seems to work maybe broken. Be careful when editing this NVRAM configuration!

##
## There are currently three directives for entry types:
##     * bytearray IDENTIFIER POSITION FIELD_SIZE
##     * string    IDENTIFIER POSITION FIELD_SIZE
##     * bitfield  IDENTIFIER n POSITION_0 .. POSITION_(n-1) VALUE_0 .. VALUE_(2^n)-1
##
## Bytearrays are a fixed number of bytes and are printed as non-prefixed hex
## bytes by default. On set operation, the exact number of bytes in the same
## format must be supplied as the value.
##
## Strings are stored as (multi-byte) chars in the system encoding and are
## printed as such. If an actual string is shorter than the field size (denoted
## by a \0 at the end), only that part of the field contents is printed.
## On set operation, the string may be at most the size of the field. A \0 is
## appended automatically, aside from the case where the field is completely
## filled -- then there is no \0 neccessary and thus, not written.
## The field size is fixed in the configuration and *not* dependend of the
## field contents.
##
## *** NOTES:
## 
##     * International characters may occupy more than one byte per character,
##       especially in the UTF-8 encoding standard on modern systems.
##     * If the system encoding is changed, string fields may produce nonsense
##       on output. Use the "iconv" utility to fix that.
##
## Bitfields are especially useful to tie together noadjacent data (a bit here,
## a bit there) so common in BIOS NVRAM data. "n" is the number of bits in the
## bitfield (so far, a maximum of 5 is hardcoded), followed by a number of
## NVRAM position codes for the bits in the format BYTE_POSITION:BIT_POSITION.
## The n position codes form a "virtual" bitfield, LSB is taken from
## position 0. Then, a number of 2^n values is applied to that "virtual"
## bitfield as the translations for certain bit combinations. A value may be
## noted more than once -- on set operation, the bit combination representing
## the first occurency of the value is written to NVRAM.


## The first 14 bytes are time & date registers of the RTC. Never change
## that registers. (Besides changing time and date, doing so on a PC with
## the DS1865 RTC may break the operation nvram utility and lead to further
## data corruption!) 
bytearray rtc_registers 0x00 14


## On an IBM PC, a 50 byte BIOS data area follows. Some of the fields are
## standard to all PC BIOS', some depend on the actual BIOS version. Maybe
## explained in detail later.
bytearray pc_bios_data 0x0E 50
bitfield floppy_a_type 3 0x10:4 0x10:5 0x10:6 none 360KB 1.2MB 720KB 1.44MB 2.88MB invalid invalid
bitfield floppy_b_type 3 0x10:0 0x10:1 0x10:2 none 360KB 1.2MB 720KB 1.44MB 2.88MB invalid invalid


## Then a variable size extended BIOS area follows. On my PC with Award BIOS,
## this field is 64 bytes long, filling up all the space up to address 127.
bytearray extended_bios_data 0x40 64



## Bytes 128 and higher are often at least partially unused by the BIOS.
## So this mapping may be up to the computer user.
##
## *** IMPORTANT NOTE:
##
## Not all systems have an extended NVRAM (Bytes 128 and higher). It
## depends on the chipset. The nvram utility currently supports the extended
## NVRAM of the following RTC chips/integrated RTCs
##     * Dallas DS1685:      256 Bytes total
##     * Intel ICHx:         256 Bytes total
##     * VIA 82Cxx and 823x: 256 Bytes total
##
bytearray TEST 0x80 8 
bitfield BF 2 128:7 128:0 A B C D
string TEST_S 0x80 4

